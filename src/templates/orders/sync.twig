{% requirePermission 'translated:orders' %}
{% set entry = craft.entries.id(data['entryId']).one() %}
{% extends '_layouts/cp' %}
{% import '_includes/forms' as forms %}
{% set title = 'Sync translated content to ' ~ entry.title %}
{% set selectedSubnavItem = 'orders' %}

{% set crumbs = [
    {
        label: 'Translated',
        url: url('translated')
    },
    {
        label: 'Orders',
        url: url('translated/orders')
    },
    {
        label: 'Order ' ~ data['entryId'],
        url: url('translated/orders/' ~ data['entryId'])
    }
] %}

{% set content %}
    <p>
        <strong class="knock">Original Entry</strong><br /> <a href="{{ entry.cpEditUrl }}">{{ entry.title }}</a>
    </p>
    <form method="post">
        {{ csrfInput() }}
        <input type="hidden" name="action" value="translated/orders/sync-order" />

        {% namespace 'order' %}
        {{
            forms.selectField({
                label: 'Site',
                instructions: 'Select which site to push the translated content to',
                id: 'siteId',
                name: 'siteId',
                required: 'required',
                options: availableSites
            })
        }}

        <input type="hidden" id="id" name="id" value="{{ data['id'] }}" />
        {% if data['entryId'] %}
            <input type="hidden" id="entryId" name="entryId" value="{{ data['entryId'] }}" />
        {% endif %}
        {% endnamespace %}

        <input type="submit" class="submit btn" value="{{ 'Sync Content'|t }}" />
    </form>
{% endset %}
